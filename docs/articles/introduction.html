<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Introduction to motiftools &bull; motiftools</title><!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous"><script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous"><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <div class="container">
      <header><div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">motiftools</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->
      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Introduction to motiftools</h1>
                        <h4 class="author">Diego Diez</h4>
            
            <h4 class="date">31 October 2016</h4>
          </div>

    
        <div class="abstract">
      <p class="abstract">Abstract</p>
      <p>Introduction to the motiftools package.</p>
    </div>
    
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>motiftools is a package for the analysis and interpretation of sequence motifs. Its initial implementation is focused on protein motif analysis obtained from the MEME suite, but its functionality may extend to other applications and tools, including analysis of nucleotide sequences and motif analysis tools found in Bioconductor or CRAN.</p>
<p>Motif ranges are stored as <code>RangedData</code> objects (<em><a href="http://bioconductor.org/packages/IRanges">IRanges</a></em>) package). This allows to include metadata, like p-value, score and other output from the search process.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(motiftools)
<span class="kw">library</span>(motifStack)</code></pre></div>
</div>
<div id="plotting-functions" class="section level1">
<h1>Plotting functions</h1>
<div id="alignments" class="section level2">
<h2>Alignments</h2>
<p>You can align any two sequences of letters. If the argument <code>score.matrix</code> is missing then a empirical scoring matrix will be generated from the sequences themeselves.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/align.html">align</a></span>(<span class="st">"FOO"</span>, <span class="st">"GOO"</span>, <span class="dt">type =</span> <span class="st">"global"</span>)</code></pre></div>
<pre><code>## $alignment
##    1 2 3
## s1 F O O
## s2 G O O
## 
## $score
## [1] 0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/align.html">align</a></span>(<span class="st">"AHSSFOO"</span>, <span class="st">"GOODFDKD"</span>, <span class="dt">type =</span> <span class="st">"global"</span>)$alignment</code></pre></div>
<pre><code>##    1 2 3 4 5 6 7 8
## s1 A H S S F - O O
## s2 G O O D F D K D</code></pre>
<p>For protein sequences you can specify a particular substitution matrix, like for example BLOSUM62.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">"BLOSUM62"</span>, <span class="dt">package =</span> <span class="st">"Biostrings"</span>)
<span class="kw"><a href="../reference/align.html">align</a></span>(<span class="st">"EGGALAPA"</span>, <span class="st">"DGGIVLPSAV"</span>, <span class="dt">score.matrix =</span> BLOSUM62, <span class="dt">type =</span> <span class="st">"global"</span>)$alignment</code></pre></div>
<pre><code>##    1 2 3 4 5 6 7 8 9 10 11
## s1 E G G - A L A P -  A  -
## s2 D G G I V L - P S  A  V</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/align.html">align</a></span>(<span class="st">"EGGALAPA"</span>, <span class="st">"DGGIVFFRF"</span>, <span class="dt">score.matrix =</span> BLOSUM62, <span class="dt">type =</span> <span class="st">"local"</span>)$alignment</code></pre></div>
<pre><code>##   1 2 3 4 5 6
## x E G G A L A
## y D G G - I V</code></pre>
</div>
<div id="motifs" class="section level2">
<h2>Motifs</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># load MEME results.</span>
f &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">"files/meme_ras/meme.xml"</span>, <span class="dt">package =</span> <span class="st">"motiftools"</span>)
x_meme &lt;-<span class="st"> </span><span class="kw"><a href="../reference/readMEME.html">readMEME</a></span>(f)
m_meme &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getMotifMatrix.html">getMotifMatrix</a></span>(x_meme)
<span class="kw"><a href="../reference/plotMatrix.html">plotMatrix</a></span>(m_meme, <span class="dt">fill =</span> <span class="kw">c</span>(<span class="st">"white"</span>, <span class="st">"grey"</span>))</code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-4-1.png" width="672"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># load FIMO results.</span>
f &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">"files/fimo_ras/fimo.xml"</span>, <span class="dt">package =</span> <span class="st">"motiftools"</span>)
x_fimo &lt;-<span class="st"> </span><span class="kw"><a href="../reference/readFIMO.html">readFIMO</a></span>(f)
m_fimo &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getMotifMatrix.html">getMotifMatrix</a></span>(x_fimo)
<span class="kw"><a href="../reference/plotMatrix.html">plotMatrix</a></span>(<span class="kw">list</span>(m_meme, m_fimo), <span class="dt">fill =</span> <span class="kw">c</span>(<span class="st">"white"</span>, <span class="st">"grey"</span>))</code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-4-2.png" width="672"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># load MAST results.</span>
f &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">"files/mast_ras/mast.xml"</span>, <span class="dt">package =</span> <span class="st">"motiftools"</span>)
x_mast &lt;-<span class="st"> </span><span class="kw"><a href="../reference/readMAST.html">readMAST</a></span>(f)
m_mast &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getMotifMatrix.html">getMotifMatrix</a></span>(x_mast)
<span class="kw"><a href="../reference/plotMatrix.html">plotMatrix</a></span>(<span class="kw">list</span>(m_meme, m_fimo, m_mast), <span class="dt">fill =</span> <span class="kw">c</span>(<span class="st">"white"</span>, <span class="st">"grey"</span>))</code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-4-3.png" width="672"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># highlight some sequences.</span>
h &lt;-<span class="st"> </span><span class="kw">grepl</span>(<span class="st">"RASH|RASK"</span>, <span class="kw"><a href="../reference/MotifSearchResult-class.html">sequenceNames</a></span>(x_meme))
<span class="kw">names</span>(h) &lt;-<span class="st"> </span><span class="kw"><a href="../reference/MotifSearchResult-class.html">sequenceNames</a></span>(x_meme)
<span class="kw"><a href="../reference/plotMatrix.html">plotMatrix</a></span>(<span class="kw">list</span>(m_meme, m_fimo, m_mast), <span class="dt">fill =</span> <span class="kw">c</span>(<span class="st">"white"</span>, <span class="st">"grey"</span>), <span class="dt">high =</span> h, <span class="dt">high.col =</span> <span class="kw">c</span>(<span class="st">"black"</span>, <span class="st">"orange"</span>))</code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-4-4.png" width="672"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># plot a motif model logo (from MEME output).</span>
p &lt;-<span class="st"> </span><span class="kw"><a href="../reference/MotifSearchResult-class.html">pwm</a></span>(x_meme)[[<span class="st">"motif_4"</span>]]
<span class="kw">plotMotifLogo</span>(p, <span class="dt">col =</span> <span class="kw">rainbow</span>(<span class="dv">20</span>))</code></pre></div>
<pre><code>## Warning in plotMotifLogo(p, col = rainbow(20)): background length is
## shorter than number of rows. Will use default background</code></pre>
<p><img src="introduction_files/figure-html/unnamed-chunk-4-5.png" width="672"></p>
</div>
<div id="sequences" class="section level2">
<h2>Sequences</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">sample</span>(<span class="dv">1</span>:<span class="dv">5</span>, <span class="dv">100</span>*<span class="dv">10</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>), <span class="dt">ncol =</span> <span class="dv">100</span>, <span class="dt">nrow =</span> <span class="dv">10</span>, <span class="dt">dimnames =</span> <span class="kw">list</span>(letters[<span class="dv">1</span>:<span class="dv">10</span>], <span class="dv">1</span>:<span class="dv">100</span>))
h &lt;-<span class="st"> </span><span class="kw">hclust</span>(<span class="kw">dist</span>(m))
<span class="kw"><a href="../reference/plotConservationMatrix.html">plotConservationMatrix</a></span>(m, h)</code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-5-1.png" width="672"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs">
    <div id="sidebar">
            <div id="tocnav">
        <h2>Contents</h2>
        <ul class="nav nav-pills nav-stacked"><li><a href="#introduction">Introduction</a></li>
        <li><a href="#plotting-functions">Plotting functions</a><ul class="nav nav-pills nav-stacked"><li><a href="#alignments">Alignments</a></li>
        <li><a href="#motifs">Motifs</a></li>
        <li><a href="#sequences">Sequences</a></li>
        </ul></li>
        </ul></div>
          </div>
  </div>

</div>


      <footer><p>Built by <a href="http://hadley.github.io/pkgdown/">pkgdown</a>. Styled with <a href="http://getbootstrap.com">Bootstrap 3</a>.</p>
      </footer></div>

  </body></html>
